<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Duplicados - LecFac</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .navbar {
            background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
            color: white;
            padding: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .navbar-header {
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .navbar h1 { font-size: 24px; font-weight: 600; }
        .navbar-actions { display: flex; gap: 15px; }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary { background: #1a73e8; color: white; }
        .btn-primary:hover { background: #1557b0; }
        .btn-secondary { background: #f1f3f4; color: #5f6368; }
        .btn-secondary:hover { background: #e8eaed; }
        .btn-danger { background: #ea4335; color: white; }
        .btn-danger:hover { background: #d93025; }
        .btn-success { background: #34a853; color: white; }
        .btn-success:hover { background: #2d9148; }
        .btn-sm { padding: 6px 12px; font-size: 13px; }
        
        .tabs {
            display: flex;
            gap: 0;
            background: #fff;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab:hover { background: rgba(0, 0, 0, 0.03); color: #333; }
        .tab.active { color: #1a73e8; border-bottom-color: #1a73e8; }
        
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            font-weight: 500;
            font-size: 14px;
        }
        
        .filter-select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
        }
        
        .stat-card .label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: 700;
            color: #1a73e8;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            background: white;
            border-radius: 8px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }
        
        .spinner {
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-top: 3px solid #1a73e8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .duplicate-container {
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }
        
        .duplicate-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f5f7fa;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .duplicate-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }
        
        .duplicate-item {
            padding: 20px;
            position: relative;
            border-right: 2px solid #e0e0e0;
        }
        
        .duplicate-item:last-child {
            border-right: none;
        }
        
        .duplicate-metadata {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .duplicate-image {
            background: #f1f3f4;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .duplicate-image img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .selection-mark {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .selected { background: #34a853; }
        .not-selected { background: #ea4335; }
        
        .select-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .similarity-tag {
            display: inline-block;
            padding: 4px 10px;
            font-weight: 500;
            font-size: 14px;
            border-radius: 12px;
        }
        
        .similarity-high { background: #e8f5e9; color: #2e7d32; }
        .similarity-medium { background: #fff3e0; color: #f57c00; }
        .similarity-low { background: #ffebee; color: #c62828; }
        
        .criteria-tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            margin-right: 5px;
            font-size: 12px;
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #34a853;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideInRight 0.3s, fadeOut 0.5s 2.5s forwards;
            max-width: 350px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #1a73e8;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .ai-settings {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .ai-settings h3 {
            margin-bottom: 15px;
            font-size: 16px;
            color: #1a73e8;
        }

        .ai-settings .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }

        .batch-actions {
            background: #e8f5e9;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .batch-actions h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .batch-status {
            margin: 15px 0;
            padding: 10px;
            border-radius: 6px;
            background: #f5f7fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .confidence-meter {
            height: 8px;
            width: 100%;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 5px 0;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff9800 0%, #4caf50 100%);
            border-radius: 4px;
            transition: width 0.3s;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-top: 20px;
        }
        
        .pagination-item {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .pagination-item:hover {
            background: #f1f3f4;
        }
        
        .pagination-item.active {
            background: #1a73e8;
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            padding: 20px;
        }

        .popup-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow: auto;
            position: relative;
        }

        .popup-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 30px;
            height: 30px;
            background: #f1f3f4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: #666;
        }

        .popup-close:hover {
            background: #e0e0e0;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-header">
            <h1>🔍 Gestor de Duplicados - LecFac</h1>
            <div class="navbar-actions">
                <a href="/" class="btn btn-secondary">← Volver al Dashboard</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- PESTAÑAS -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('productos')">📦 Productos Duplicados</button>
            <button class="tab" onclick="switchTab('facturas')">🧾 Facturas Duplicadas</button>
            <button class="tab" onclick="switchTab('configuracion')">⚙️ Configuración IA</button>
        </div>

        <!-- ========================================== -->
        <!-- TAB: PRODUCTOS DUPLICADOS -->
        <!-- ========================================== -->
        <div id="tab-productos" class="tab-content active">
            <div class="toolbar">
                <div class="filters">
                    <div class="filter-group">
                        <span class="filter-label">Umbral de Similitud:</span>
                        <select id="umbralSimilitud" class="filter-select">
                            <option value="90">Muy Alta (90%+)</option>
                            <option value="85" selected>Alta (85%+)</option>
                            <option value="75">Media (75%+)</option>
                            <option value="65">Baja (65%+)</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <span class="filter-label">Criterios:</span>
                        <select id="criteriosProductos" class="filter-select">
                            <option value="todos" selected>Todos los criterios</option>
                            <option value="codigo">Mismo código</option>
                            <option value="nombre">Nombre similar</option>
                            <option value="establecimiento">Mismo establecimiento</option>
                        </select>
                    </div>
                </div>

                <div>
                    <button class="btn btn-primary" onclick="detectarProductosDuplicados()">
                        🔍 Detectar Duplicados
                    </button>
                    <button class="btn btn-secondary" onclick="mostrarAyudaProductos()">
                        ❓ Ayuda
                    </button>
                </div>
            </div>

            <!-- PANEL DE IA -->
            <div class="batch-actions" id="productos-ia-panel" style="display: none;">
                <h3>🤖 Procesamiento con Inteligencia Artificial</h3>
                <p>Usa IA para analizar y procesar automáticamente los duplicados detectados.</p>
                
                <div class="filter-group" style="margin-top: 10px;">
                    <span class="filter-label">Nivel de confianza mínimo:</span>
                    <select id="confianzaProductos" class="filter-select">
                        <option value="90">Muy Alto (90%+)</option>
                        <option value="85" selected>Alto (85%+)</option>
                        <option value="75">Medio (75%+)</option>
                    </select>
                </div>
                
                <div class="batch-status" id="productos-batch-status" style="display: none;">
                    <div style="flex: 1;">
                        <p>Progreso: <span id="productos-progreso">0/0</span></p>
                        <div class="confidence-meter">
                            <div class="confidence-fill" id="productos-progress-bar" style="width: 0%;"></div>
                        </div>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="cancelarProcesamientoIA('productos')">Cancelar</button>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-success" onclick="procesarDuplicadosIA('productos')">🤖 Procesar con IA</button>
                    <button class="btn btn-primary" onclick="guardarResultadosIA('productos')">💾 Guardar Resultados</button>
                </div>
            </div>

            <!-- ESTADÍSTICAS -->
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="label">Productos Totales</div>
                    <div class="value" id="total-productos">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">Duplicados Encontrados</div>
                    <div class="value" id="total-duplicados">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">Procesados por IA</div>
                    <div class="value" id="productos-procesados-ia">0</div>
                </div>
                <div class="stat-card">
                    <div class="label">Fusiones Realizadas</div>
                    <div class="value" id="total-fusiones">0</div>
                </div>
            </div>

            <!-- CONTENEDOR DE DUPLICADOS -->
            <div id="productos-duplicados-container">
                <div class="empty-state">
                    <h3>Haz clic en "Detectar Duplicados" para comenzar</h3>
                    <p>El sistema analizará productos similares según los criterios seleccionados</p>
                </div>
            </div>

            <!-- PAGINACIÓN -->
            <div class="pagination" id="productos-pagination"></div>
        </div>

        <!-- ========================================== -->
        <!-- TAB: FACTURAS DUPLICADAS -->
        <!-- ========================================== -->
        <div id="tab-facturas" class="tab-content">
            <div class="toolbar">
                <div class="filters">
                    <div class="filter-group">
                        <span class="filter-label">Criterio Principal:</span>
                        <select id="criterioFacturas" class="filter-select">
                            <option value="all" selected>Todos los criterios</option>
                            <option value="same_establishment">Mismo establecimiento</option>
                            <option value="same_date">Misma fecha</option>
                            <option value="same_total">Mismo total</option>
                            <option value="same_products">Productos similares</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <span class="filter-label">Ver imágenes:</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mostrarImagenes" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div>
                    <button class="btn btn-primary" onclick="detectarFacturasDuplicadas()">
                        🔍 Detectar Duplicados
                    </button>
                    <button class="btn btn-secondary" onclick="mostrarAyudaFacturas()">
                        ❓ Ayuda
                    </button>
                </div>
            </div>

            <!-- PANEL DE IA -->
            <div class="batch-actions" id="facturas-ia-panel" style="display: none;">
                <h3>🤖 Procesamiento con Inteligencia Artificial</h3>
                <p>Usa IA para analizar y procesar automáticamente las facturas duplicadas.</p>
                
                <div class="filter-group" style="margin-top: 10px;">
                    <span class="filter-label">Nivel de confianza mínimo:</span>
                    <select id="confianzaFacturas" class="filter-select">
                        <option value="90">Muy Alto (90%+)</option>
                        <option value="85" selected>Alto (85%+)</option>
                        <option value="75">Medio (75%+)</option>
                    </select>
                </div>
                
                <div class="batch-status" id="facturas-batch-status" style="display: none;">
                    <div style="flex: 1;">
                        <p>Progreso: <span id="facturas-progreso">0/0</span></p>
                        <div class="confidence-meter">
                            <div class="confidence-fill" id="facturas-progress-bar" style="width: 0%;"></div>
                        </div>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="cancelarProcesamientoIA('facturas')">Cancelar</button>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-success" onclick="procesarDuplicadosIA('facturas')">🤖 Procesar con IA</button>
                    <button class="btn btn-primary" onclick="guardarResultadosIA('facturas')">💾 Guardar Resultados</button>
                </div>
            </div>

            <!-- ESTADÍSTICAS -->
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="label">Facturas Totales</div>
                    <div class="value" id="total-facturas">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">Duplicados Encontrados</div>
                    <div class="value" id="total-facturas-duplicadas">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">Procesados por IA</div>
                    <div class="value" id="facturas-procesadas-ia">0</div>
                </div>
                <div class="stat-card">
                    <div class="label">Eliminaciones</div>
                    <div class="value" id="total-eliminaciones">0</div>
                </div>
            </div>

            <!-- CONTENEDOR DE DUPLICADOS -->
            <div id="facturas-duplicadas-container">
                <div class="empty-state">
                    <h3>Haz clic en "Detectar Duplicados" para comenzar</h3>
                    <p>El sistema analizará facturas similares según los criterios seleccionados</p>
                </div>
            </div>

            <!-- PAGINACIÓN -->
            <div class="pagination" id="facturas-pagination"></div>
        </div>

        <!-- ========================================== -->
        <!-- TAB: CONFIGURACIÓN IA -->
        <!-- ========================================== -->
        <div id="tab-configuracion" class="tab-content">
            <div class="ai-settings">
                <h3>⚙️ Configuración de la Inteligencia Artificial</h3>
                
                <div class="filter-group" style="margin-top: 15px;">
                    <span class="filter-label">API Key Anthropic:</span>
                    <input type="password" id="apiKey" class="filter-select" 
                           style="width: 350px;" placeholder="sk-ant-...">
                </div>

                <div class="filter-group" style="margin-top: 15px;">
                    <span class="filter-label">Modelo:</span>
                    <select id="modeloIA" class="filter-select">
                        <option value="claude-3-5-sonnet-20241022" selected>Claude 3.5 Sonnet (recomendado)</option>
                        <option value="claude-3-haiku-20240307">Claude 3 Haiku (rápido y económico)</option>
                        <option value="claude-3-opus-20240229">Claude 3 Opus (máxima precisión)</option>
                    </select>
                </div>
                
                <div class="divider"></div>

                <h3>📋 Criterios de Fusión para Productos</h3>
                <div class="filter-group">
                    <textarea id="criteriosProductosIA" class="filter-select" 
                              style="width: 100%; height: 150px; resize: vertical; font-family: monospace; font-size: 13px;">
                    </textarea>
                </div>
                
                <div class="divider"></div>

                <h3>🗑️ Criterios de Eliminación para Facturas</h3>
                <div class="filter-group">
                    <textarea id="criteriosFacturasIA" class="filter-select" 
                              style="width: 100%; height: 150px; resize: vertical; font-family: monospace; font-size: 13px;">
                    </textarea>
                </div>
                
                <div class="divider"></div>

                <div class="filter-group" style="margin-top: 15px;">
                    <span class="filter-label">Tamaño de lote para procesamiento:</span>
                    <select id="tamanoLote" class="filter-select">
                        <option value="5">5 por lote</option>
                        <option value="10" selected>10 por lote</option>
                        <option value="25">25 por lote</option>
                        <option value="50">50 por lote</option>
                    </select>
                </div>
                
                <div class="filter-group" style="margin-top: 15px;">
                    <span class="filter-label">Intervalo de procesamiento (segundos):</span>
                    <input type="number" id="intervaloLote" class="filter-select" 
                           value="5" min="1" max="60" style="width: 100px;">
                </div>
                
                <button class="btn btn-primary" onclick="guardarConfiguracionIA()" style="margin-top: 20px;">
                    💾 Guardar Configuración
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- POPUPS -->
    <!-- ========================================== -->
    
    <!-- POPUP: Ayuda Productos -->
    <div id="popup-ayuda-productos" class="popup">
        <div class="popup-content">
            <div class="popup-close" onclick="cerrarPopup('popup-ayuda-productos')">✕</div>
            <h2>❓ Ayuda: Detección de Productos Duplicados</h2>
            <p style="margin: 15px 0;">El sistema utiliza varios criterios para detectar productos duplicados y te ayuda a mantener tu base de datos limpia.</p>
            <div style="background: #f5f7fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <h3>Criterios de Detección:</h3>
                <ul style="list-style: none; padding-left: 0; margin-top: 10px;">
                    <li style="margin-bottom: 8px;">✓ <strong>Mismo código EAN</strong> + mismo establecimiento</li>
                    <li style="margin-bottom: 8px;">✓ <strong>Nombres similares</strong> (>85% similitud) + mismo establecimiento</li>
                    <li>✓ <strong>Variaciones de formato</strong> (ej: "500g" vs "1/2 kg")</li>
                </ul>
            </div>
            <button class="btn btn-primary" onclick="cerrarPopup('popup-ayuda-productos')">Entendido</button>
        </div>
    </div>

    <!-- POPUP: Ayuda Facturas -->
    <div id="popup-ayuda-facturas" class="popup">
        <div class="popup-content">
            <div class="popup-close" onclick="cerrarPopup('popup-ayuda-facturas')">✕</div>
            <h2>❓ Ayuda: Detección de Facturas Duplicadas</h2>
            <p style="margin: 15px 0;">El sistema busca facturas que probablemente sean duplicadas según múltiples criterios.</p>
            <div style="background: #f5f7fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <h3>Criterios de Detección:</h3>
                <ul style="list-style: none; padding-left: 0; margin-top: 10px;">
                    <li style="margin-bottom: 8px;">✓ Misma <strong>fecha + establecimiento + total</strong></li>
                    <li style="margin-bottom: 8px;">✓ Misma <strong>fecha + establecimiento + productos similares</strong></li>
                    <li>✓ Mismo <strong>número de referencia</strong></li>
                </ul>
            </div>
            <div style="background: #ffebee; padding: 15px; border-radius: 8px; margin: 15px 0;">
                <p><strong>⚠️ Importante:</strong> Al eliminar una factura, se borran permanentemente todos sus datos. Asegúrate de mantener la factura más completa.</p>
            </div>
            <button class="btn btn-primary" onclick="cerrarPopup('popup-ayuda-facturas')">Entendido</button>
        </div>
    </div>

    <!-- POPUP: Imagen Ampliada -->
    <div id="popup-imagen" class="popup">
        <div class="popup-content" style="text-align: center;">
            <div class="popup-close" onclick="cerrarPopup('popup-imagen')">✕</div>
            <h3 id="popup-imagen-titulo">Vista Ampliada</h3>
            <img id="popup-imagen-contenido" src="" alt="Imagen de factura" 
                 style="max-width: 100%; max-height: 70vh; border-radius: 8px; margin-top: 15px;">
        </div>
    </div>

    <!-- CARGAR JAVASCRIPT -->
    <script src="/static/duplicados.js"></script>
</body>
</html>
